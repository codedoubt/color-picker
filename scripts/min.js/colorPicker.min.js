var $=function(e){return"#"==e[0]?document.getElementById(e.slice(1)):"."==e[0]?document.getElementsByClassName(e.slice(1)):document.getElementsByTagName(e)};function ColorPicker(e){var t=e.bound,o=e.boundHandle,a=e.picker,n=e.pickHandle,i=e.slider,l=e.slideHandle,f=e.options,d=e.output,r=e.onchange||function(){},c=a.getContext("2d"),g=i.getContext("2d");function u(e,t){c.fillStyle="hsl("+(e||0)+",100%,50%)",c.rect(0,0,t.width,t.height),c.fill();var o=c.createLinearGradient(0,0,t.width,0),a=c.createLinearGradient(0,0,0,t.height);o.addColorStop(0,"rgba(255,255,255,1)"),o.addColorStop(1,"rgba(255,255,255,0)"),a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)"),c.fillStyle=o,c.fillRect(0,0,t.width,t.height),c.fillStyle=a,c.fillRect(0,0,t.width,t.height)}draggable(o,{attach:!0,attachTo:"#"+t.id}),draggable(n,{bound:!0,boundTo:"#"+a.id,offLeft:-5,offTop:-5,onmove:L}),draggable(l,{bound:!0,boundTo:"#"+i.id,dragY:!1,offLeft:-10,offTop:-2,onmove:b}),u(null,a);for(var h=0;h<=360;h++)g.fillStyle="hsl("+h+",100%,50%)",g.fillRect(h*i.width/360,0,2,20);i.addEventListener("click",function(e){var o=e.pageX-t.offsetLeft-22.5;log(i.offsetLeft),y(360*o/i.width),b(e)}),a.addEventListener("click",function(e){T(e.pageX-t.offsetLeft-5,e.pageY-t.offsetTop-o.offsetHeight-5),L(e)});var s=function(e){u(e,a)},p=function(e,t){var o=c.getImageData(e,t,1,1);return[o.data[0],o.data[1],o.data[2]]};function v(e){d.value="",d.value=e,cb(e)}function y(e){var t=Math.round(205*e/360)-10;l.style.left=t+"px"}function T(e,t){n.style.top=t+"px",n.style.left=e+"px"}function b(e){(o=e.pageX-t.offsetLeft-22.5)<0&&(o=0),o>i.width&&(o=i.width),log(),u(Math.round(360*o/i.width),a),T();var o,l=n.offsetTop;w(o=n.offsetLeft,l)}function L(e){w(e.pageX-t.offsetLeft-5,e.pageY-t.offsetTop-o.offsetHeight-5)}function w(e,t){e<0&&(e=0),t<0&&(t=0),e>249.5&&(e=249.5),t>249.5&&(t=249.5);var o=p(e,t),a=o[0],n=o[1],i=o[2],l=f.value;v(changeToSelectedType("rgb",l,toRgbString(a,n,i)))}f.addEventListener("change",function(){var e=d.value,t=colorType(e);v(changeToSelectedType(t,this.value,e))}),d.addEventListener("keyup",function(){var e=this.value,t=colorType(e);f.value=e?t:"hex";try{var o=changeToSelectedType(t,"hsl",e),n=o.match(/[0-9]+[.]?[0-9]?[0-9]?/g).filter(function(e){return""!=e}),i=n[0],l=n[1],d=n[2];s(i),y(i);var c=l*a.width/100,g=d*a.width/100;T(c-5,a.width-g-5),r(e)}catch(e){log("wrong input value")}})}