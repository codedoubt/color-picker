var $=function(e){return"#"==e[0]?document.getElementById(e.slice(1)):"."==e[0]?document.getElementsByClassName(e.slice(1)):document.getElementsByTagName(e)};function ColorPicker(e){var t=e.bound,o=e.boundHandle,n=e.picker,a=e.pickHandle,i=e.slider,l=e.slideHandle,f=e.options,d=e.output,r=e.onchange||function(){},c=n.getContext("2d"),u=i.getContext("2d");function g(e,t){c.fillStyle="hsl("+(e||0)+",100%,50%)",c.rect(0,0,t.width,t.height),c.fill();var o=c.createLinearGradient(0,0,t.width,0),n=c.createLinearGradient(0,0,0,t.height);o.addColorStop(0,"rgba(255,255,255,1)"),o.addColorStop(1,"rgba(255,255,255,0)"),n.addColorStop(0,"rgba(0,0,0,0)"),n.addColorStop(1,"rgba(0,0,0,1)"),c.fillStyle=o,c.fillRect(0,0,t.width,t.height),c.fillStyle=n,c.fillRect(0,0,t.width,t.height)}draggable(o,{attach:!0,attachTo:"#"+t.id}),draggable(a,{bound:!0,boundTo:"#"+n.id,offLeft:-5,offTop:-5,onmove:L}),draggable(l,{bound:!0,boundTo:"#"+i.id,dragY:!1,offLeft:-10,offTop:-2,onmove:b}),g(null,n);for(var h=0;h<=360;h++)u.fillStyle="hsl("+h+",100%,50%)",u.fillRect(h*i.width/360,0,2,20);i.addEventListener("click",function(e){var o=e.pageX-t.offsetLeft-22.5;log(i.offsetLeft),y(360*o/i.width),b(e)}),n.addEventListener("click",function(e){T(e.pageX-t.offsetLeft-5,e.pageY-t.offsetTop-o.offsetHeight-5),L(e)});var s=function(e){g(e,n)},p=function(e,t){var o=c.getImageData(e,t,1,1);return[o.data[0],o.data[1],o.data[2]]};function v(e){d.value="",d.value=e,cb(e)}function y(e){var t=Math.round(205*e/360)-10;l.style.left=t+"px"}function T(e,t){a.style.top=t+"px",a.style.left=e+"px"}function b(e){(o=e.pageX-t.offsetLeft-22.5)<0&&(o=0),o>i.width&&(o=i.width),log(),g(Math.round(360*o/i.width),n),T();var o,l=a.offsetTop;w(o=a.offsetLeft,l)}function L(e){w(e.clientX-t.offsetLeft-5,e.clientY-t.offsetTop-o.offsetHeight-5)}function w(e,t){e<0&&(e=0),t<0&&(t=0),e>249.5&&(e=249.5),t>249.5&&(t=249.5);var o=p(e,t),n=o[0],a=o[1],i=o[2],l=f.value;v(changeToSelectedType("rgb",l,toRgbString(n,a,i)))}f.addEventListener("change",function(){var e=d.value,t=colorType(e);v(changeToSelectedType(t,this.value,e))}),d.addEventListener("keyup",function(){var e=this.value,t=colorType(e);f.value=e?t:"hex";try{var o=changeToSelectedType(t,"hsl",e),a=o.match(/[0-9]+[.]?[0-9]?[0-9]?/g).filter(function(e){return""!=e}),i=a[0],l=a[1],d=a[2];s(i),y(i);var c=l*n.width/100,u=d*n.width/100;T(c-5,n.width-u-5),r(e)}catch(e){log("wrong input value")}})}